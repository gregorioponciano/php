<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visão do Código do Sistema de Cadastro e Login</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <header>
        <h1>Sistema de Cadastro e Login</h1>
        <p>Veja os códigos utilizados no cadastro e login de usuários</p>
    </header>

    <main>
        <!-- Seção de Conexão com o Banco de Dados -->
        <section>
            <h2>1. Conexão com o Banco de Dados (conexao.php)</h2>
            <p>Crie o arquivo <strong>conexao.php</strong> para gerenciar a conexão com o <a href="https://gregorioponciano.github.io/mysql/index.html">banco de dados</a>.</p>
            <div class="code">
                <span class="keyword">&lt;?php</span><br>
                <span class="comment">// Arquivo de conexão com o banco de dados</span><br>
                <span class="variable">$host</span> = <span class="string">'localhost'</span>;<br>
                <span class="variable">$user</span> = <span class="string">'root'</span>;<br>
                <span class="variable">$password</span> = <span class="string">''</span>;<br>
                <span class="variable">$dbname</span> = <span class="string">'cadastro'</span>;<br><br>

                <span class="comment">// Conexão</span><br>
                <span class="variable">$conn</span> = <span class="keyword">new</span> <span class="function">mysqli</span>($host, $user, $password, $dbname);<br>
                <span class="keyword">if</span> ($conn->connect_error) {<br>
                &emsp;<span class="function">die</span>(<span class="string">"Erro na conexão: "</span> . $conn->connect_error);<br>
                }<br>
                <span class="keyword">?&gt;</span>
            </div>
        </section>

        <!-- Seção de Cadastro -->
        <section>
            <h2>2. Código de Cadastro (cadastrar.php)</h2>
            <p>Código PHP que processa o cadastro e armazena os dados no banco de dados.</p>
            <div class="code">
                <span class="keyword">&lt;?php</span><br>
                <span class="function">include</span>(<span class="string">'conexao.php'</span>);<br><br>

                <span class="comment">// Receber dados</span><br>
                <span class="variable">$nome</span> = $_POST[<span class="string">'nome'</span>];<br>
                <span class="variable">$email</span> = $_POST[<span class="string">'email'</span>];<br>
                <span class="variable">$senha</span> = <span class="function">password_hash</span>($_POST[<span class="string">'senha'</span>], <span class="keyword">PASSWORD_DEFAULT</span>);<br><br>

                <span class="comment">// Inserção no banco</span><br>
                <span class="variable">$sql</span> = <span class="string">"INSERT INTO usuarios (nome, email, senha) VALUES ('$nome', '$email', '$senha')"</span>;<br>
                <span class="keyword">if</span> ($conn->query($sql) === <span class="keyword">TRUE</span>) {<br>
                &emsp;<span class="function">echo</span> <span class="string">"Cadastro realizado com sucesso!"</span>;<br>
                } <span class="keyword">else</span> {<br>
                &emsp;<span class="function">echo</span> <span class="string">"Erro: "</span> . $conn->error;<br>
                }<br>
                <span class="keyword">?&gt;</span>
            </div>
        </section>

        <!-- Seção de Login -->
        <section>
            <h2>3. Código de Login (login.php)</h2>
            <p>Verifica as credenciais do usuário e cria uma sessão ao realizar o login.</p>
            <div class="code">
                <span class="keyword">&lt;?php</span><br>
                <span class="function">session_start</span>();<br>
                <span class="function">include</span>(<span class="string">'conexao.php'</span>);<br><br>

                <span class="variable">$email</span> = $_POST[<span class="string">'email'</span>];<br>
                <span class="variable">$senha</span> = $_POST[<span class="string">'senha'</span>];<br><br>

                <span class="variable">$sql</span> = <span class="string">"SELECT * FROM usuarios WHERE email = '$email'"</span>;<br>
                <span class="variable">$result</span> = $conn->query($sql);<br>
                <span class="keyword">if</span> ($result->num_rows > 0) {<br>
                &emsp;<span class="variable">$user</span> = $result->fetch_assoc();<br>
                &emsp;<span class="keyword">if</span> (<span class="function">password_verify</span>($senha, $user[<span class="string">'senha'</span>])) {<br>
                &emsp;&emsp;<span class="function">$_SESSION</span>[<span class="string">'user'</span>] = $user[<span class="string">'nome'</span>];<br>
                &emsp;&emsp;<span class="function">header</span>(<span class="string">'Location: protegido.php'</span>);<br>
                &emsp;} <span class="keyword">else</span> {<br>
                &emsp;&emsp;<span class="function">echo</span> <span class="string">"Senha incorreta!"</span>;<br>
                &emsp;}<br>
                } <span class="keyword">else</span> {<br>
                &emsp;<span class="function">echo</span> <span class="string">"Usuário não encontrado!"</span>;<br>
                }<br>
                <span class="keyword">?&gt;</span>
            </div>
        </section>

        <!-- Seção de Logout -->
        <section>
            <h2>4. Código de Logout (logout.php)</h2>
            <p>Finaliza a sessão do usuário e redireciona para a página de login.</p>
            <div class="code">
                <span class="keyword">&lt;?php</span><br>
                <span class="function">session_start</span>();<br>
                <span class="function">session_unset</span>();<br>
                <span class="function">session_destroy</span>();<br>
                <span class="function">header</span>(<span class="string">'Location: login.html'</span>);<br>
                <span class="keyword">exit</span>;<br>
                <span class="keyword">?&gt;</span>
            </div>
        </section>

        <!-- Seção de Página Protegida -->
        <section>
            <h2>5. Página Protegida (protegido.php)</h2>
            <p>Página que só pode ser acessada por usuários logados.</p>
            <div class="code">
                <span class="keyword">&lt;?php</span><br>
                <span class="function">session_start</span>();<br>
                <span class="keyword">if</span> (!<span class="function">isset</span>(<span class="function">$_SESSION</span>[<span class="string">'user'</span>])) {<br>
                &emsp;<span class="function">header</span>(<span class="string">'Location: login.html'</span>);<br>
                &emsp;<span class="function">exit</span>;<br>
                }<br>
                <span class="function">echo</span> <span class="string">"Bem-vindo, "</span> . <span class="function">$_SESSION</span>[<span class="string">'user'</span>];<br>
                <span class="keyword">?&gt;</span>
            </div>
        </section>

    </main>

    <footer>
        <p>&copy; 2024 Meu Site. Todos os direitos reservados.</p>
    </footer>

</body>

</html>
